{
    "app-id": "com.github.taiko2k.tauonmb",
    "runtime": "org.gnome.Platform",
    "runtime-version": "48",
    "sdk": "org.gnome.Sdk",
    "sdk-extensions": [
        "org.freedesktop.Sdk.Extension.rust-stable"
    ],
    "command": "com.github.taiko2k.tauonmb.sh",
    "add-extensions": {
        "org.freedesktop.Platform.ffmpeg-full": {
            "version": "24.08",
            "directory": "lib/ffmpeg",
            "add-ld-path": ".",
            "autodelete": false
        }
    },
    "cleanup-commands": [
        "mkdir -p ${FLATPAK_DEST}/lib/ffmpeg"
    ],
    "finish-args": [
        "--share=ipc",
        "--share=network",
        "--socket=wayland",
        "--socket=fallback-x11",
        "--socket=pulseaudio",
        "--device=all",
        "--filesystem=xdg-music",
        "--filesystem=xdg-download",
        "--filesystem=xdg-run/app/com.discordapp.Discord:create",
        "--filesystem=xdg-run/discord-ipc-0",
        "--filesystem=xdg-run/pipewire-0",
        "--system-talk-name=org.freedesktop.login1",
        "--talk-name=org.freedesktop.Notifications",
        "--talk-name=org.kde.StatusNotifierWatcher",
        "--own-name=org.mpris.MediaPlayer2.tauon"
    ],
    "modules": [
        "shared-modules/libappindicator/libappindicator-gtk3-introspection-12.10.json",
        "python-pylast.json",
        "python-dbus-deps.json",
        "python-tekore-deps.json",
        "python-frozenlist.json",
        "python3-scikit-build-core.json",
        "python3-poetry-core.json",
        "python3-modules.json",
        "librespot.json",
        "sdl3.json",
        "fonts.json",
        "libopenmpt.json",
        "wavpack.json",
        "opusfile.json",
        "libgme.json",
        "python-cairo.json",
        {
            "name": "tauonmb-git",
            "buildsystem": "simple",
            "build-commands": [
                "bash run.sh 5",
                "python3 compile_translations.py",
                "mkdir -p /app/share/locale",
                "mv src/tauon/locale /app/share/",
                "mkdir -p /app/bin",
                "cp -r * /app/bin/",
                "mkdir -p /app/share/icons/hicolor/scalable/apps",
                "mkdir -p /app/share/icons/hicolor/symbolic/apps",
                "install -D extra/tauonmb.svg /app/share/icons/hicolor/scalable/apps/${FLATPAK_ID}.svg",
                "install -D extra/tauonmb-symbolic.svg /app/share/icons/hicolor/symbolic/apps/${FLATPAK_ID}-symbolic.svg",
                "install -D src/tauon/assets/icon-64.png /app/share/icons/hicolor/64x64/apps/${FLATPAK_ID}.png",
                "install -D src/tauon/assets/icon-128.png /app/share/icons/hicolor/128x128/apps/${FLATPAK_ID}.png",
                "install -D extra/com.github.taiko2k.tauonmb.appdata.xml /app/share/metainfo/${FLATPAK_ID}.appdata.xml",
                "install -D extra/com.github.taiko2k.tauonmb.desktop /app/share/applications/${FLATPAK_ID}.desktop",
                "install -D extra/com.github.taiko2k.tauonmb.sh /app/bin/com.github.taiko2k.tauonmb.sh"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/Taiko2k/Tauon.git",
                    "commit": "b1543b25e9adb12d431dd79f7ac04758404c52d5"
                }
            ]
        }
    ]
}
